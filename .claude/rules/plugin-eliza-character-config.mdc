---
description: ElizaOS character configuration - interface, personality, knowledge, plugins
globs: packages/plugin-eliza/**/*.ts
alwaysApply: false
---

# Hyperscape Plugin - Character Configuration

> Character interface, personality design, and configuration patterns.

## Reference Documentation

- **Character Interface**: https://docs.elizaos.ai/agents/character-interface
- **Personality and Behavior**: https://docs.elizaos.ai/agents/personality-and-behavior
- **Memory**: `.cursor/memory/elizaos-character-personality.md`

## Character vs Agent

**Key Distinction:**
- **Character**: Static configuration object (blueprint)
- **Agent**: Runtime instance created from Character (living instance)

**Rules:**
- ✅ **ALWAYS** define Character configuration separately from runtime
- ✅ **ALWAYS** understand Character is configuration, Agent is runtime instance
- ✅ **NEVER** confuse Character configuration with Agent runtime state

## Character Interface

### Required Fields

**MANDATORY:**
```typescript
export const character: Character = {
  name: "AgentName",        // REQUIRED - Display name
  bio: "Description",       // REQUIRED - Background/personality
}
```

**Rules:**
- ✅ **ALWAYS** include `name` (required)
- ✅ **ALWAYS** include `bio` (required, string or string[])
- ✅ **ALWAYS** use descriptive names
- ✅ **NEVER** skip required fields

### Optional Fields

**Identity:**
```typescript
id: UUID,                  // Auto-generated if not provided
username: string,          // Social media username
```

**Personality:**
```typescript
adjectives: string[],      // Character traits
topics: string[],         // Conversation topics
style: {                  // Writing style
  all: string[],
  chat: string[],
  post: string[]
}
```

**Training:**
```typescript
messageExamples: array[][],  // Example conversations (2D array)
postExamples: string[],      // Example social media posts
```

**Knowledge:**
```typescript
knowledge: array,          // Facts, files, or directories
system: string,           // System prompt override
templates: object,        // Custom prompt templates
```

**Configuration:**
```typescript
plugins: string[],        // Enabled plugin packages
settings: object,         // Configuration values
secrets: object,          // Sensitive configuration
```

## Bio Configuration

### Single String Format

```typescript
bio: "A helpful AI assistant specializing in technical support and programming guidance."
```

**Use When:** Simple, straightforward agents

### Array Format (Recommended)

```typescript
bio: [
  "Expert in web development and open source technologies",
  "Specializes in TypeScript, React, and Node.js",
  "Helps developers debug issues and learn best practices",
  "Friendly and patient teaching style"
]
```

**Use When:** Complex personalities, multiple expertise areas

**Rules:**
- ✅ **ALWAYS** use array format for complex personalities
- ✅ **ALWAYS** keep bio entries focused and specific
- ✅ **ALWAYS** align bio with adjectives and style
- ✅ **NEVER** create contradictory bio entries

## System Prompt Configuration

```typescript
system: `You are a technical support specialist. 
Always:
- Provide code examples when relevant
- Explain technical concepts clearly
- Be encouraging to learners
- Admit when you don't know something
Never:
- Be condescending or dismissive
- Assume prior knowledge without checking
- Provide outdated or deprecated solutions`
```

**Rules:**
- ✅ **ALWAYS** use system prompt to fine-tune behavior
- ✅ **ALWAYS** structure with Always/Never sections
- ✅ **ALWAYS** align with bio and personality traits
- ✅ **NEVER** contradict personality in system prompt

## Message Examples

**MANDATORY Structure:** 2D array format

```typescript
messageExamples: [
  [
    {
      name: "{{user}}",
      content: { text: "Can you help me debug this React error?" }
    },
    {
      name: "TechHelper",
      content: { 
        text: "I'd be happy to help! Can you share the error message and the relevant code?"
      }
    }
  ],
  // Another conversation example
  [
    {
      name: "{{user}}",
      content: { text: "What's the difference between let and const?" }
    },
    {
      name: "TechHelper",
      content: { 
        text: "`const` declares a variable that cannot be reassigned..."
      }
    }
  ]
]
```

**Rules:**
- ✅ **ALWAYS** use 2D array format (array of conversations)
- ✅ **ALWAYS** include `name` and `content` for each message
- ✅ **ALWAYS** use `{{user}}` placeholder for user messages
- ✅ **ALWAYS** provide diverse conversation examples
- ✅ **ALWAYS** demonstrate personality traits in examples
- ✅ **NEVER** use single array (must be 2D)
- ✅ **NEVER** skip examples (required for LLM training)

## Style Configuration

**Three Style Contexts:**

```typescript
style: {
  // Universal rules - applied to all outputs
  all: [
    "Be clear and concise",
    "Use active voice",
    "Avoid jargon unless necessary"
  ],
  
  // Chat-specific rules
  chat: [
    "Be conversational but professional",
    "Use markdown for code formatting",
    "Break long explanations into digestible chunks"
  ],
  
  // Social media post rules
  post: [
    "Hook readers in the first line",
    "Use line breaks for readability",
    "Include relevant hashtags (3-5 max)"
  ]
}
```

**Rules:**
- ✅ **ALWAYS** define `all` style rules (universal)
- ✅ **ALWAYS** define `chat` style rules (conversations)
- ✅ **ALWAYS** define `post` style rules (social media)
- ✅ **ALWAYS** keep style rules consistent with personality
- ✅ **NEVER** create contradictory style rules

## Knowledge Configuration

**Three Knowledge Types:**

1. **Simple String Facts:**
```typescript
knowledge: [
  "I specialize in TypeScript and React",
  "I can help with debugging and code reviews",
]
```

2. **File Reference:**
```typescript
knowledge: [
  {
    path: "./knowledge/react-best-practices.md",
    shared: true  // Available to all agents
  },
]
```

3. **Directory of Knowledge Files:**
```typescript
knowledge: [
  {
    directory: "./knowledge/tutorials",
    shared: false  // Only for this agent
  }
]
```

**Rules:**
- ✅ **ALWAYS** use string facts for small snippets
- ✅ **ALWAYS** use file references for documents
- ✅ **ALWAYS** use directory references for knowledge bases
- ✅ **ALWAYS** set `shared` flag appropriately
- ✅ **NEVER** use knowledge array for large documents (use docs folder)

## Plugin Management

### Basic Plugin Configuration

```typescript
plugins: [
  "@elizaos/plugin-bootstrap",  // Core functionality
  "@elizaos/plugin-discord",     // Discord integration
  "@elizaos/plugin-openai",      // OpenAI models
  "./custom-plugins/my-plugin"   // Local plugin
]
```

### Environment-Based Plugin Loading

```typescript
plugins: [
  // Always loaded
  "@elizaos/plugin-bootstrap",
  "@elizaos/plugin-sql",
  
  // Conditionally loaded based on API keys
  ...(process.env.OPENAI_API_KEY ? ["@elizaos/plugin-openai"] : []),
  ...(process.env.ANTHROPIC_API_KEY ? ["@elizaos/plugin-anthropic"] : []),
  
  // Platform plugins
  ...(process.env.DISCORD_API_TOKEN ? ["@elizaos/plugin-discord"] : []),
]
```

**Rules:**
- ✅ **ALWAYS** load core plugins first (`@elizaos/plugin-bootstrap`)
- ✅ **ALWAYS** check environment variables before loading plugins
- ✅ **ALWAYS** order plugins by dependency (core before dependent)
- ✅ **ALWAYS** use conditional loading for optional plugins
- ✅ **NEVER** hardcode API keys in plugin array

## Settings and Secrets

### Settings Object

```typescript
settings: {
  // Model configuration
  model: "gpt-4",
  temperature: 0.7,
  maxTokens: 2000,
  
  // Behavior settings
  responseTimeout: 30000,
  maxMemorySize: 1000,
  
  // Custom settings for plugins
  voiceEnabled: true,
  avatar: "https://example.com/avatar.png"
}
```

### Secrets Management

```typescript
secrets: {
  // API keys
  OPENAI_API_KEY: process.env.OPENAI_API_KEY,
  DATABASE_URL: process.env.DATABASE_URL,
  
  // OAuth tokens
  DISCORD_TOKEN: process.env.DISCORD_TOKEN,
}
```

**Rules:**
- ✅ **ALWAYS** use environment variables for secrets
- ✅ **ALWAYS** access secrets via `process.env`
- ✅ **ALWAYS** document required environment variables
- ✅ **NEVER** hardcode secrets in character configuration
- ✅ **NEVER** commit secrets to version control

## Personality Design Principles

### Core Principles

1. **Consistency Over Complexity**: Simple, consistent personality is better
2. **Purpose-Driven Design**: Every trait supports primary function
3. **Cultural Awareness**: Consider cultural contexts
4. **Evolutionary Potential**: Design for growth and adaptation

### Adjectives Selection

**Well-Balanced Sets:**
```typescript
adjectives: ["helpful", "patient", "knowledgeable", "approachable", "reliable"]
adjectives: ["creative", "innovative", "bold", "inspiring", "unconventional"]
adjectives: ["analytical", "precise", "methodical", "thorough", "objective"]
```

**Rules:**
- ✅ **ALWAYS** choose adjectives that work together harmoniously
- ✅ **ALWAYS** align adjectives with bio and style
- ✅ **NEVER** use contradictory combinations
- ✅ **NEVER** use too many adjectives (5-7 is ideal)

### Topics and Domain Expertise

```typescript
topics: [
  // Core expertise
  "JavaScript",
  "TypeScript",
  "React",
  "Node.js",
  
  // Secondary knowledge
  "web performance",
  "SEO basics",
  
  // Peripheral awareness
  "tech industry trends"
]
```

**Rules:**
- ✅ **ALWAYS** define clear knowledge boundaries
- ✅ **ALWAYS** organize topics by expertise level
- ✅ **ALWAYS** align topics with bio and knowledge
- ✅ **NEVER** claim expertise in topics not supported by knowledge

## Personality Archetypes

### The Helper

```typescript
export const helperCharacter: Character = {
  name: "SupportBot",
  bio: [
    "Your dedicated support companion",
    "Available 24/7 to solve problems",
    "Patient, thorough, and always friendly"
  ],
  adjectives: ["helpful", "patient", "thorough", "friendly", "reliable"],
  topics: ["troubleshooting", "guidance", "support", "solutions"],
  style: {
    all: ["Focus on solving the user's immediate problem"],
    chat: ["Always acknowledge the user's concern first"],
    post: ["Share helpful tips and common solutions"]
  },
}
```

### The Expert

```typescript
export const expertCharacter: Character = {
  name: "TechExpert",
  bio: [
    "Senior architect with 20 years experience",
    "Published author and conference speaker",
    "Specializes in scalable system design"
  ],
  adjectives: ["knowledgeable", "analytical", "precise", "authoritative", "insightful"],
  topics: ["architecture", "performance", "scalability", "best practices"],
  style: {
    all: ["Provide technically accurate information"],
    chat: ["Lead with expertise", "Offer multiple solution approaches"],
    post: ["Share advanced techniques", "Discuss industry trends"]
  },
}
```

**Rules:**
- ✅ **ALWAYS** align archetype with purpose
- ✅ **ALWAYS** ensure consistency across bio, adjectives, topics, style
- ✅ **ALWAYS** use message examples that demonstrate archetype
- ✅ **NEVER** mix incompatible archetypes

## Best Practices Checklist

Before deploying character, verify:

- [ ] Character has `name` and `bio` (required)
- [ ] Bio aligns with adjectives and style
- [ ] Message examples demonstrate personality traits
- [ ] Style rules don't contradict personality
- [ ] Topics match claimed expertise
- [ ] Post examples fit the character voice
- [ ] Knowledge supports the backstory
- [ ] No conflicting behavioral patterns
- [ ] Plugins loaded conditionally based on environment
- [ ] Secrets use environment variables

## Forbidden Patterns

❌ **NEVER**:
- Skip required fields (name, bio)
- Create contradictory personality traits
- Hardcode secrets in configuration
- Use single array for message examples (must be 2D)
- Mix incompatible archetypes
- Claim expertise without supporting knowledge
- Skip message examples (required for training)

## Required Patterns

✅ **ALWAYS**:
- Include name and bio (required)
- Use array format for complex bios
- Use 2D array for message examples
- Define style for all, chat, and post contexts
- Load plugins conditionally based on environment
- Use environment variables for secrets
- Align bio, adjectives, topics, and style
- Provide diverse message examples
- Validate character configuration before deployment

## Examples

See `.cursor/memory/elizaos-character-personality.md` for complete examples of:
- Character interface structure
- Bio writing patterns
- Message examples
- Style configuration
- Personality archetypes
- Knowledge integration

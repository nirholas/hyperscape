---
description: Directory structure and file organization for Hyperscape plugin
globs: packages/plugin-eliza/**/*.ts
alwaysApply: false
---

# Hyperscape Plugin - Directory Structure

> File organization and directory-specific rules for the Hyperscape plugin.

## Directory Organization

### `src/index.ts` - Plugin Entry Point
- Export plugin as `hyperscapePlugin` and default export
- Use Zod for configuration validation
- Register components in order: services → providers → actions → events
- Reference: @packages/plugin-eliza/src/index.ts

### `src/actions/` - Action Implementations
- Group related actions in same file
- Export actions as named exports
- Files: `movement.ts`, `combat.ts`, `skills.ts`, `inventory.ts`, `social.ts`, `banking.ts`

### `src/providers/` - Context Providers
- One provider per file
- Files: `gameState.ts`, `inventory.ts`, `nearbyEntities.ts`, `skills.ts`, `equipment.ts`, `availableActions.ts`

### `src/managers/` - Specialized Managers
- One manager per file: `{name}-manager.ts`
- Files: `behavior-manager.ts`, `build-manager.ts`, `emote-manager.ts`, `message-manager.ts`, etc.

### `src/systems/` - Hyperscape World Systems
- Extend `System` from `@hyperscape/shared`
- Files: `actions.ts`, `avatar.ts`, `environment.ts`, `liveKit.ts`, `loader.ts`, `PlayerMovementSystem.ts`

### `src/types/` - Type Definitions
- Import from `@hyperscape/shared` for Hyperscape types
- Import from `@elizaos/core` for ElizaOS types
- Define plugin-specific types here
- Re-export from `index.ts`

### `src/config/` - Configuration Constants
- Use `as const` for configuration objects
- Read from `process.env` with defaults
- File: `constants.ts` with NETWORK_CONFIG, AGENT_CONFIG, etc.

### `src/templates/` - Prompt Templates
- Export all templates from `index.ts`
- Use template literals with placeholders
- Files: `index.ts` (all templates)

### `src/utils/` - Utility Functions
- Pure functions when possible
- Export as named exports
- File: `ai-helpers.ts` for AI utilities

### `src/__tests__/` - Test Files
- Use Vitest for testing
- Unit tests: `__tests__/{category}/{name}.test.ts`
- E2E tests: `__tests__/e2e/`
- Test helpers: `__tests__/helpers/`

## File Naming Conventions

- Actions: `actions/{category}.ts` (e.g., `movement.ts`)
- Providers: `providers/{name}.ts` (e.g., `gameState.ts`)
- Managers: `managers/{name}-manager.ts` (e.g., `behavior-manager.ts`)
- Systems: `systems/{name}.ts` (e.g., `actions.ts`)
- Types: `types/{category}.ts` (e.g., `core-types.ts`)
- Tests: `__tests__/{category}/{name}.test.ts`

## Import Paths

```typescript
// ✅ DO: Use explicit .js extensions for ESM
import { HyperscapeService } from './services/HyperscapeService.js';
import { moveToAction } from './actions/movement.js';

// ✅ DO: Use relative paths within plugin
import type { GameStateData } from '../types.js';

// ✅ DO: Import from packages
import type { IAgentRuntime } from '@elizaos/core';
import type { World } from '@hyperscape/shared';
```

## Import Order

1. External packages (`@elizaos/core`, `@hyperscape/shared`)
2. Internal types
3. Internal utilities
4. Internal constants
